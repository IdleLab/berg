language: ruby
rvm:
- 2.3.0
env:
- RACK_ENV=test
addons:
  postgresql: "9.4"
cache:
  directories:
    - vendor/bundle
    - node_modules
    - travis_phantomjs
before_install:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- "phantomjs --version"
- "export PATH=$PWD/travis_phantomjs/phantomjs-2.1.1-linux-x86_64/bin:$PATH"
- "phantomjs --version"
- "if [ $(phantomjs --version) != '2.1.1' ]; then rm -rf $PWD/travis_phantomjs; mkdir -p $PWD/travis_phantomjs; fi"
- "if [ $(phantomjs --version) != '2.1.1' ]; then wget https://assets.membergetmember.co/software/phantomjs-2.1.1-linux-x86_64.tar.bz2 -O $PWD/travis_phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2; fi"
- "if [ $(phantomjs --version) != '2.1.1' ]; then tar -xvf $PWD/travis_phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2 -C $PWD/travis_phantomjs; fi"
- "phantomjs --version"
before_script:
- psql -c 'create database berg_test;' -U postgres
- cp ./config/application.travisci.yml ./config/application.yml
- nvm install 4.4.2
- nvm use 4.4.2
- npm install -g npm
- npm install
script:
- bundle exec rake assets:precompile
- bundle exec rake db:migrate
- bundle exec rake spec
notifications:
  email: false
  slack:
    on_success: change
    on_failure: change
    secure: cm3eNphNT4FqMpw/pmlXmPjyo3TpnLeEzaN+ANRoia2qE/KpLw8rmD5RB30dyWraTrPdNM7MFauixKtLQvyOizhomn7ImcDISr7dM0imN0tkRMVF5AT1tMqThTjX5ReNKneYDu5p5aBpwdU12SMpfP8HgQ1NywLIcP5304TON8MiKNUOml8XRbvM5vWk6A+YWxVIyJ2l8px2D08fCnfENZdrNPfQLBr/NnTXsZX6NRyAsKkkc0li2vTrLACmVgbiNRRGvNgXacMrVxmlMLmZYTSO6lr2k4+NtE09uX4cETe3tyVuZfvW8cit/pME8ViaS6xrPnX9rNI6auWdcRjc4MEgBeZv0946zxwhkBH+RmjyUmhg0YvAEbK4Jo+iA2QzYIHK7VlByIlifuri5lqah3DS2qNzRNlNYzNmIIq2cFxtzosM1WNNSay7bF6Co2IINYjDxulKbLMnRJgUGP0uf1+QiU27Rh1/z9nqsnoPUaC+olFhcyD2FK+vlIe0kjkMtakJQr5a/VePEYm8tDUtFwLJNESwiZfjRN86EuLfdk//Qj+wm3v2xrrYwNqYL2/TcLorJ4Fpv7lM++eL8bPndsDzLtsOW2mi3cTUDE+zMk2pCjY4G0sGJHkL9+t/jbi2Chy7+wnN7BVAGotOQOVnROyoMNXoV8C+3stJFnITWe4=
